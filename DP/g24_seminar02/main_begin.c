/** 
  * Seminar Session #2: Modular arithmetic

  Slow simulation: use the native Simulator provided in mcu8051ide
  Fast simulation: sdcc-s51 -X 12000000 -t 51 main.ihx < simulation.dat
**/

#include <8051.h>

#define SIZE 128

//======================================================
// Do not delete this, it is used by the fast simulator
volatile __xdata __at (0xFFFE) unsigned char startBrk;
volatile __xdata __at (0xFFFF) unsigned char endBrk;
//======================================================

// Global external RAM, specified with the __xdata parameter
//  __at (0x000) indicates the starting memory position	
volatile __xdata __at (0x0000) unsigned char x[SIZE] = {0xA3,0x71,0x79,0x01,0xFC,0xF2,0x93,0xC7,0x1C,0x69,0x2D,0x67,0x38,0x2B,0x7C,0x1A,0x40,0x88,0xBA,0x9B,0x10,0x53,0x65,0xED,0xFE,0x39,0xB4,0x77,0x3B,0xC8,0x9B,0xB2,0xE4,0xB1,0xA3,0xC9,0xCD,0xC8,0xF2,0x69,0x01,0x91,0x87,0x67,0xAC,0x6E,0x56,0xF1,0x60,0xBF,0x1E,0x0F,0x53,0xA8,0xAF,0x40,0xDB,0x76,0xB2,0xEA,0x90,0xDD,0xFF,0x40,0x0C,0xD2,0x4D,0xDC,0x5E,0xB3,0xE7,0xFA,0xB4,0x53,0x5E,0x75,0x0B,0x91,0x92,0x14,0x7E,0xD8,0xB8,0xA7,0x05,0x95,0xD0,0x55,0x97,0x30,0x78,0x41,0x81,0xEF,0xC6,0x64,0x9F,0x4A,0x9C,0x4A,0x3A,0x0B,0xCA,0xD8,0x9C,0x1A,0x64,0xA7,0xA9,0x6E,0xC8,0x0A,0xE5,0xCE,0xE2,0x3B,0x73,0x8A,0xEF,0xF0,0xE4,0xA6,0x40,0x26,0xF3,0xD9,0x50,0x1F};

volatile __xdata __at (0x0080) unsigned char y[SIZE] = {0xBD,0xAA,0x18,0x4C,0xCD,0x5C,0x95,0x35,0x5B,0xA2,0x9D,0xC0,0xEB,0xE2,0x8A,0xC6,0xBF,0xDF,0xA1,0x88,0x1B,0x8C,0x58,0xE3,0xB0,0xD8,0xF8,0xC6,0xB6,0x01,0x96,0xE2,0xE0,0x52,0x01,0x0B,0x3A,0xFF,0x65,0x48,0xE0,0x67,0xCD,0x9E,0x1E,0x6A,0xA4,0xFC,0x04,0xC5,0x7B,0x1C,0xF0,0x2B,0xD1,0x4E,0x62,0xFB,0x36,0x68,0xB9,0x70,0xC8,0x98,0x0C,0x8A,0x65,0x3C,0xD1,0x15,0x2B,0x13,0xCA,0x5A,0xB7,0xBA,0xFC,0x15,0x37,0x11,0x6C,0xF3,0x93,0x85,0x9B,0x1E,0xE8,0x28,0x44,0x4B,0xFB,0x6A,0xFD,0xEC,0xC9,0xCB,0xC9,0x07,0x28,0x2B,0x96,0xE0,0xF9,0xA5,0x8C,0x35,0x62,0xCC,0xAB,0xB9,0xF3,0xA2,0xA9,0x4D,0x24,0x07,0x16,0x87,0xF4,0x31,0xBB,0xBC,0x6D,0x0A,0x88,0xE5,0x47,0x7D};

volatile __xdata __at (0x0100) unsigned char m[SIZE] = {0x0D,0xD5,0x0F,0x26,0x8F,0x95,0xAD,0x59,0x24,0xA0,0xDA,0x8F,0xAE,0x27,0x9F,0xD4,0x7A,0xE7,0x7E,0xBF,0xDF,0x2D,0x12,0xDA,0x43,0x14,0x0F,0x20,0xFA,0x90,0x46,0xD5,0x39,0xF1,0xAA,0x90,0x02,0xE4,0xDC,0xA3,0x9C,0xA4,0xF2,0xFF,0x30,0xC1,0x14,0x22,0x7E,0x11,0xE3,0x77,0x00,0x1A,0xAD,0x50,0xE1,0x7B,0x91,0x4A,0x92,0x08,0x65,0x20,0x75,0x68,0x74,0xB3,0x65,0xB0,0x0C,0xC6,0x8B,0xC9,0x10,0xEF,0xC4,0x4E,0x45,0xAD,0xFA,0xD2,0x4F,0x06,0xEC,0x29,0x5C,0xF3,0xAA,0x97,0x82,0x70,0xB8,0x44,0x06,0x86,0xE0,0x67,0xFC,0x70,0x79,0xA4,0xF0,0xB3,0x0B,0x48,0xCD,0xF0,0x6C,0x6F,0x0B,0x8B,0x25,0x67,0x46,0x8F,0xEC,0xA4,0xC1,0xE3,0x6A,0x47,0x0D,0xEB,0xA3,0x81,0xB5,0xBA};

volatile __xdata __at (0x180) unsigned char sprime[SIZE] = 
{0x3B,0xFE,0x13,0x49,0x55,0x1C,0x95,0x10,0x74,0x60,0xFA,0xE6,0x25,0x4B,0x97,0x8A,0x34,0x92,0x37,0x72,0xAE,0x1B,0x7D,0xCE,0x9D,0x5F,0xEC,0x6C,0x13,0x0E,0xFE,0xC7,0xB3,0xD4,0xB4,0x03,0x4C,0x8B,0xAE,0x0D,0x86,0xDC,0x65,0x06,0xC4,0xBB,0x5D,0x15,0xBE,0x76,0x26,0x08,0x57,0x60,0xD8,0x83,0x76,0x38,0x1C,0xDE,0x3B,0x16,0x94,0x2D,0xCC,0xA5,0x8B,0x45,0x2D,0x32,0x87,0x12,0x18,0x99,0xDE,0x4C,0x2B,0x16,0x24,0xFA,0x2A,0x69,0x04,0x9C,0xE8,0xF3,0x2B,0x08,0x79,0xA8,0xC6,0xED,0xB8,0xD8,0x1A,0x45,0x57,0x0C,0x40,0xD7,0x37,0xA6,0x19,0xCD,0x5A,0x56,0xDE,0xF6,0x29,0xDB,0x15,0x5A,0x0B,0x48,0x43,0x36,0xED,0xFD,0xBD,0x90,0x35,0x81,0x3B,0xA3,0x18,0x54,0xB1,0xD7};

// Global internal RAM (chosen by the compiler by default)
unsigned char i;

void mod_addition(unsigned char *res, unsigned char *in1, unsigned char *in2, unsigned char * modulus)
{
	// The modulus m is constant and independent of the inputs
	// You can use it directly, i.e. without passing them as pointers
	
}

void mod_subtraction(unsigned char *res, unsigned char *in1, unsigned char *in2, unsigned char * modulus)
{
	// The modulus m is constant and independent of the inputs
	// You can use it directly, i.e. without passing them as pointers
	
}

void montgomery_multiplication(unsigned char *res, unsigned char *in1, unsigned char *in2, unsigned char * modulus)
{
	// You can use the vector sprime directly,
	// i.e. without passing it as pointer
	
}

int main() 
{
	//======================================================
	// Do not delete this, it is used by the fast simulator
	startBrk = 1;
	//======================================================

	/**  Your task starts here **/
	

	//======================================================
	// Do not delete this, it is used by the fast simulator
	endBrk=1;
	//======================================================
	return 0;
}
